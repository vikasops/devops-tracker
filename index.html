<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevOps Tracker - Firebase Debug</title>
    <!-- Firebase SDK v9 (latest stable) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <style>
:root {
  --primary: #2563eb;
  --primary-light: #3b82f6;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --bg: #f8fafc;
  --surface: #ffffff;
  --border: #e2e8f0;
  --text: #1e293b;
  --text-muted: #64748b;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  line-height: 1.6;
  color: var(--text);
  background-color: var(--bg);
}

.container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }

/* Debug Panel */
.debug-panel {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
  width: 400px;
  max-height: 80vh;
  z-index: 1000;
  overflow: hidden;
}

.debug-header {
  background: var(--primary);
  color: white;
  padding: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
}

.debug-content {
  padding: 1rem;
  max-height: 70vh;
  overflow-y: auto;
}

.debug-content.collapsed { display: none; }

.debug-item {
  margin-bottom: 1rem;
  padding: 0.75rem;
  border-radius: 6px;
  border: 1px solid;
  font-size: 0.875rem;
}

.debug-item.success {
  background: rgba(16, 185, 129, 0.1);
  border-color: var(--success);
  color: #065f46;
}

.debug-item.warning {
  background: rgba(245, 158, 11, 0.1);
  border-color: var(--warning);
  color: #92400e;
}

.debug-item.error {
  background: rgba(239, 68, 68, 0.1);
  border-color: var(--danger);
  color: #dc2626;
}

.debug-label {
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.debug-value {
  font-family: monospace;
  font-size: 0.8rem;
  word-break: break-all;
  background: rgba(0,0,0,0.05);
  padding: 0.25rem;
  border-radius: 3px;
}

.debug-test-btn {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  cursor: pointer;
  font-size: 0.875rem;
  margin: 0.25rem 0.5rem 0.25rem 0;
}

.debug-test-btn:hover { background: var(--primary-light); }
.debug-test-btn:disabled { background: #94a3b8; cursor: not-allowed; }

/* Header */
.header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  padding: 1rem 0;
  position: sticky;
  top: 0;
  z-index: 100;
}

.header .container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 1rem;
}

.header__title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--primary);
  text-decoration: none;
}

.header__controls {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  flex-wrap: wrap;
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 6px;
  font-size: 0.875rem;
  font-weight: 500;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.2s;
  white-space: nowrap;
}

.btn--sm { padding: 0.375rem 0.75rem; font-size: 0.8rem; }
.btn--primary { background: var(--primary); color: white; }
.btn--primary:hover { background: var(--primary-light); }
.btn--outline { background: transparent; color: var(--primary); border: 1px solid var(--primary); }
.btn--outline:hover { background: var(--primary); color: white; }
.btn--danger { background: var(--danger); color: white; }
.btn:disabled { opacity: 0.6; cursor: not-allowed; }

/* Landing */
.landing {
  min-height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4rem 0;
}

.landing__content {
  text-align: center;
  max-width: 600px;
}

.landing__title {
  font-size: 3rem;
  font-weight: 800;
  margin-bottom: 1rem;
  line-height: 1.2;
}

.landing__subtitle {
  font-size: 1.25rem;
  color: var(--text-muted);
  margin-bottom: 2rem;
}

/* Auth Modal */
.auth-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  backdrop-filter: blur(4px);
}

.auth-modal.hidden { display: none; }

.auth-form {
  background: white;
  padding: 2rem;
  border-radius: 8px;
  box-shadow: 0 20px 40px rgba(0,0,0,0.1);
  width: 100%;
  max-width: 400px;
  margin: 1rem;
  position: relative;
}

.auth-form h2 {
  margin-bottom: 1.5rem;
  text-align: center;
  font-size: 1.5rem;
  font-weight: 600;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  font-size: 0.875rem;
}

.form-control {
  width: 100%;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 1rem;
  transition: all 0.2s;
}

.form-control:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.error {
  color: var(--danger);
  font-size: 0.875rem;
  margin-top: 0.5rem;
  padding: 0.75rem;
  background: rgba(239, 68, 68, 0.1);
  border-radius: 6px;
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.success {
  color: var(--success);
  font-size: 0.875rem;
  margin-top: 0.5rem;
  padding: 0.75rem;
  background: rgba(16, 185, 129, 0.1);
  border-radius: 6px;
  border: 1px solid rgba(16, 185, 129, 0.2);
}

.close-modal {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  font-size: 1.5rem;
  color: var(--text-muted);
  cursor: pointer;
  width: 2rem;
  height: 2rem;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.close-modal:hover { background: var(--border); }

.auth-switch {
  text-align: center;
  margin-top: 1rem;
  font-size: 0.875rem;
  color: var(--text-muted);
  padding-top: 1rem;
  border-top: 1px solid var(--border);
}

.auth-switch button {
  background: none;
  border: none;
  color: var(--primary);
  cursor: pointer;
  font-weight: 500;
  text-decoration: underline;
  margin-left: 0.25rem;
}

/* Main app */
.main {
  padding: 2rem 0;
  min-height: 80vh;
}

.hidden { display: none !important; }

/* Footer */
.footer {
  margin-top: 4rem;
  padding: 2rem 0;
  border-top: 1px solid var(--border);
  background: var(--surface);
  text-align: center;
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* Responsive */
@media (max-width: 768px) {
  .debug-panel {
    position: relative;
    top: 0;
    right: 0;
    width: 100%;
    margin: 1rem 0;
  }

  .landing__title { font-size: 2rem; }
  .landing__subtitle { font-size: 1rem; }
}
    </style>
</head>
<body>
    <!-- Debug Panel -->
    <div class="debug-panel">
        <div class="debug-header" id="debugHeader">
            <h4>üîß Firebase Debug Console</h4>
            <button class="debug-toggle" id="debugToggle" style="background: none; border: none; color: white; cursor: pointer; padding: 0.25rem;">‚àí</button>
        </div>
        <div class="debug-content" id="debugContent">
            <div id="debugInfo">
                <div class="debug-item warning" id="configStatus">
                    <div class="debug-label">üîß Configuration Status</div>
                    <div class="debug-value" id="configValue">Checking Firebase configuration...</div>
                </div>

                <div class="debug-item warning" id="firebaseStatus">
                    <div class="debug-label">üî• Firebase Connection</div>
                    <div class="debug-value" id="firebaseValue">Testing Firebase initialization...</div>
                </div>

                <div class="debug-item" id="authStatus">
                    <div class="debug-label">üîê Authentication Status</div>
                    <div class="debug-value" id="authValue">Not authenticated</div>
                </div>

                <div class="debug-item" id="domainStatus">
                    <div class="debug-label">üåê Domain Authorization</div>
                    <div class="debug-value" id="domainValue">Current: ${window.location.hostname}</div>
                </div>

                <div class="debug-item" id="databaseStatus">
                    <div class="debug-label">üóÑÔ∏è Database Status</div>
                    <div class="debug-value" id="databaseValue">Not tested</div>
                </div>
            </div>

            <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                <button class="debug-test-btn" id="testAuthBtn">Test Auth</button>
                <button class="debug-test-btn" id="testDbBtn">Test Database</button>
                <button class="debug-test-btn" id="clearLogsBtn">Clear Console</button>
            </div>

            <div id="debugLogs" style="margin-top: 1rem; font-size: 0.75rem; max-height: 200px; overflow-y: auto; background: #1a202c; color: #e2e8f0; padding: 0.5rem; border-radius: 4px; font-family: monospace;"></div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="auth-modal hidden" id="authModal">
        <div class="auth-form">
            <button class="close-modal" id="closeModal">&times;</button>
            <h2 id="authTitle">Welcome Back</h2>
            <form id="authForm">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" class="form-control" required placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" class="form-control" required placeholder="Enter your password (6+ characters)">
                </div>
                <div id="authError" class="error hidden"></div>
                <div id="authSuccess" class="success hidden"></div>
                <div class="form-group">
                    <button type="submit" class="btn btn--primary" style="width: 100%;" id="authSubmit">
                        Sign In
                    </button>
                </div>
                <div class="auth-switch">
                    <span id="authSwitchText">Don't have an account?</span>
                    <button type="button" id="authSwitchBtn">Sign Up</button>
                </div>
            </form>
        </div>
    </div>

    <header class="header">
        <div class="container">
            <a href="#" class="header__title" id="homeLink">DevOps Tracker - Debug Mode</a>
            <div class="header__controls">
                <!-- Guest Navigation -->
                <div id="guestNav">
                    <button class="btn btn--outline btn--sm" id="signInBtn">Sign In</button>
                    <button class="btn btn--primary btn--sm" id="signUpBtn">Sign Up</button>
                </div>

                <!-- Authenticated Navigation -->
                <div id="authNav" class="hidden">
                    <span id="userEmail" style="margin-right: 1rem; font-size: 0.875rem; color: var(--text-muted);"></span>
                    <button class="btn btn--danger btn--sm" id="signOutBtn">Sign Out</button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- Landing Page -->
        <section class="landing" id="landingSection">
            <div class="container">
                <div class="landing__content">
                    <h1 class="landing__title">DevOps Tracker - Debug Mode</h1>
                    <p class="landing__subtitle">
                        This debug version will help identify and fix Firebase authentication issues.
                        Check the debug panel in the top-right corner for real-time diagnostics.
                    </p>

                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                        <button class="btn btn--primary" style="padding: 0.75rem 1.5rem; font-size: 1rem;" id="getStartedBtn">Test Sign Up</button>
                        <button class="btn btn--outline" style="padding: 0.75rem 1.5rem; font-size: 1rem;" id="demoModeBtn">Demo Mode</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tracker App (shown after login) -->
        <div class="main hidden" id="trackerApp">
            <div class="container">
                <h2>‚úÖ Authentication Successful!</h2>
                <p>Firebase authentication is working correctly. You can now build the full tracker interface.</p>
                <div style="margin-top: 2rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 6px; border-left: 4px solid var(--success);">
                    <h3 style="color: var(--success); margin-bottom: 0.5rem;">üéâ Success!</h3>
                    <p style="margin-bottom: 0;">Your Firebase setup is working perfectly. You're ready to deploy the full DevOps tracker!</p>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p><strong>Firebase Debug Mode</strong> - Diagnostics for DevOps Tracker</p>
            <p style="margin-top: 0.5rem;">Check the debug panel for detailed Firebase status and error information.</p>
        </div>
    </footer>

    <script>
// Firebase Configuration - REPLACE WITH YOUR ACTUAL CONFIG
const firebaseConfig = {
  apiKey: "AIzaSyD4adoJJjOAeGLqPBQFZAP88oWAbneH8uQ",
  authDomain: "devopstracker-5863d.firebaseapp.com",
  projectId: "devopstracker-5863d",
  storageBucket: "devopstracker-5863d.firebasestorage.app",
  messagingSenderId: "359527400053",
  appId: "1:359527400053:web:564b8c6ffc1377a19e2e3c",
  measurementId: "G-XZH6ZS212V"
};

// Debug Logger Class
class DebugLogger {
    constructor() {
        this.logs = [];
        this.maxLogs = 50;
        this.logElement = document.getElementById('debugLogs');
    }

    log(message, type = 'info') {
        const timestamp = new Date().toLocaleTimeString();
        const logEntry = { timestamp, message, type };
        this.logs.push(logEntry);

        if (this.logs.length > this.maxLogs) {
            this.logs.shift();
        }

        this.updateDisplay();
        console.log(`[${type.toUpperCase()}] ${message}`);
    }

    error(message) { this.log(`‚ùå ${message}`, 'error'); }
    warn(message) { this.log(`‚ö†Ô∏è ${message}`, 'warning'); }
    success(message) { this.log(`‚úÖ ${message}`, 'success'); }
    info(message) { this.log(`‚ÑπÔ∏è ${message}`, 'info'); }

    clear() {
        this.logs = [];
        this.updateDisplay();
    }

    updateDisplay() {
        if (this.logElement) {
            this.logElement.innerHTML = this.logs.slice(-15).map(log => 
                `<div style="margin-bottom: 0.25rem;">[${log.timestamp}] ${log.message}</div>`
            ).join('');
            this.logElement.scrollTop = this.logElement.scrollHeight;
        }
    }
}

const logger = new DebugLogger();

// Firebase Debug Diagnostics
class FirebaseDebugger {
    constructor() {
        this.isConfigured = false;
        this.isInitialized = false;
        this.auth = null;
        this.db = null;

        this.runDiagnostics();
    }

    async runDiagnostics() {
        logger.info('Starting Firebase diagnostics...');

        // Step 1: Check configuration
        this.checkConfiguration();

        // Step 2: Initialize Firebase
        await this.initializeFirebase();

        // Step 3: Test services
        if (this.isInitialized) {
            await this.testServices();
        }

        logger.info('Diagnostics complete');
    }

    checkConfiguration() {
        const configStatus = document.getElementById('configStatus');
        const configValue = document.getElementById('configValue');

        if (firebaseConfig.apiKey === "AIzaSyD4adoJJjOAeGLqPBQFZAP88oWAbneH8uQ" || 
            !firebaseConfig.apiKey || 
            !firebaseConfig.projectId) {

            configStatus.className = 'debug-item error';
            configValue.innerHTML = `
                <strong>‚ùå Configuration Missing</strong><br>
                Please replace the firebaseConfig object with your actual Firebase configuration.
            `;
            logger.error('Firebase configuration not set up correctly');
            return false;
        }

        configStatus.className = 'debug-item success';
        configValue.innerHTML = `
            <strong>‚úÖ Configuration Found</strong><br>
            Project: ${firebaseConfig.projectId}<br>
            Domain: ${firebaseConfig.authDomain}
        `;
        logger.success('Firebase configuration loaded');
        this.isConfigured = true;
        return true;
    }

    async initializeFirebase() {
        const firebaseStatus = document.getElementById('firebaseStatus');
        const firebaseValue = document.getElementById('firebaseValue');

        if (!this.isConfigured) {
            firebaseStatus.className = 'debug-item error';
            firebaseValue.textContent = 'Cannot initialize - configuration missing';
            return;
        }

        try {
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
            this.auth = firebase.auth();
            this.db = firebase.firestore();

            firebaseStatus.className = 'debug-item success';
            firebaseValue.innerHTML = `
                <strong>‚úÖ Firebase Initialized</strong><br>
                Auth: Ready<br>
                Firestore: Ready
            `;

            logger.success('Firebase services initialized successfully');
            this.isInitialized = true;

            // Set up auth state listener
            this.auth.onAuthStateChanged((user) => {
                this.updateAuthStatus(user);
                if (user) {
                    logger.success(`User signed in: ${user.email}`);
                } else {
                    logger.info('User signed out or not authenticated');
                }
            });

        } catch (error) {
            firebaseStatus.className = 'debug-item error';
            firebaseValue.innerHTML = `
                <strong>‚ùå Initialization Failed</strong><br>
                Error: ${error.message}
            `;
            logger.error(`Firebase initialization failed: ${error.message}`);
        }
    }

    updateAuthStatus(user) {
        const authStatus = document.getElementById('authStatus');
        const authValue = document.getElementById('authValue');

        if (user) {
            authStatus.className = 'debug-item success';
            authValue.innerHTML = `
                <strong>‚úÖ Authenticated</strong><br>
                Email: ${user.email}<br>
                UID: ${user.uid}<br>
                Verified: ${user.emailVerified}
            `;
        } else {
            authStatus.className = 'debug-item';
            authValue.textContent = 'Not authenticated';
        }
    }

    async testServices() {
        // Test domain authorization
        await this.testDomainAuth();

        // Test database connection
        await this.testDatabase();
    }

    async testDomainAuth() {
        const domainStatus = document.getElementById('domainStatus');
        const domainValue = document.getElementById('domainValue');

        const currentDomain = window.location.hostname;

        domainStatus.className = 'debug-item warning';
        domainValue.innerHTML = `
            <strong>‚ö†Ô∏è Domain Check</strong><br>
            Current: ${currentDomain}<br>
            <small>Ensure "${currentDomain}" is in Firebase Auth ‚Üí Settings ‚Üí Authorized domains</small>
        `;

        logger.warn(`Ensure ${currentDomain} is authorized in Firebase console`);
    }

    async testDatabase() {
        const databaseStatus = document.getElementById('databaseStatus');
        const databaseValue = document.getElementById('databaseValue');

        if (!this.db) {
            databaseStatus.className = 'debug-item error';
            databaseValue.textContent = 'Firestore not initialized';
            return;
        }

        try {
            // Test basic database connection
            const testDoc = await this.db.collection('test').limit(1).get();

            databaseStatus.className = 'debug-item success';
            databaseValue.innerHTML = `
                <strong>‚úÖ Database Connected</strong><br>
                Firestore: Accessible<br>
                Rules: Test mode recommended
            `;

            logger.success('Database connection successful');

        } catch (error) {
            if (error.code === 'permission-denied') {
                databaseStatus.className = 'debug-item warning';
                databaseValue.innerHTML = `
                    <strong>‚ö†Ô∏è Permission Denied</strong><br>
                    Set Firestore to test mode:<br>
                    <code>allow read, write: if request.time < timestamp.date(2025, 12, 31);</code>
                `;
                logger.warn('Database permissions need configuration');
            } else {
                databaseStatus.className = 'debug-item error';
                databaseValue.innerHTML = `
                    <strong>‚ùå Database Error</strong><br>
                    ${error.message}
                `;
                logger.error(`Database error: ${error.message}`);
            }
        }
    }
}

// Main Application Class
class DevOpsTracker {
    constructor() {
        this.user = null;
        this.isSignUp = false;
        this.debugger = null;

        this.init();
    }

    async init() {
        logger.info('Initializing DevOps Tracker...');

        // Initialize debugger
        this.debugger = new FirebaseDebugger();

        // Bind events
        this.bindEvents();
        this.bindAuthEvents();
        this.bindDebugEvents();

        logger.info('Application initialized');
    }

    bindDebugEvents() {
        // Debug panel toggle
        document.getElementById('debugToggle').addEventListener('click', () => {
            const content = document.getElementById('debugContent');
            const toggle = document.getElementById('debugToggle');

            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                toggle.textContent = '‚àí';
            } else {
                content.classList.add('collapsed');
                toggle.textContent = '+';
            }
        });

        // Test buttons
        document.getElementById('testAuthBtn').addEventListener('click', () => {
            this.testAuthentication();
        });

        document.getElementById('testDbBtn').addEventListener('click', async () => {
            await this.debugger.testDatabase();
        });

        document.getElementById('clearLogsBtn').addEventListener('click', () => {
            logger.clear();
        });
    }

    bindAuthEvents() {
        // Form submission
        document.getElementById('authForm').addEventListener('submit', (e) => {
            e.preventDefault();
            this.handleAuth(e);
        });

        // Mode switching
        document.getElementById('authSwitchBtn').addEventListener('click', (e) => {
            e.preventDefault();
            this.toggleAuthMode();
        });

        // Show modal buttons
        document.getElementById('signInBtn').addEventListener('click', () => {
            this.showAuthModal('signin');
        });

        document.getElementById('signUpBtn').addEventListener('click', () => {
            this.showAuthModal('signup');
        });

        document.getElementById('getStartedBtn').addEventListener('click', () => {
            this.showAuthModal('signup');
        });

        document.getElementById('demoModeBtn').addEventListener('click', () => {
            this.startDemoMode();
        });

        // Sign out
        document.getElementById('signOutBtn').addEventListener('click', () => {
            this.signOut();
        });

        // Close modal
        document.getElementById('closeModal').addEventListener('click', () => {
            this.hideAuthModal();
        });
    }

    bindEvents() {
        // Click outside modal to close
        const authModal = document.getElementById('authModal');
        authModal.addEventListener('click', (e) => {
            if (e.target === authModal) {
                this.hideAuthModal();
            }
        });
    }

    showAuthModal(mode = 'signin') {
        this.isSignUp = mode === 'signup';
        this.updateAuthModalMode();

        const modal = document.getElementById('authModal');
        modal.classList.remove('hidden');

        setTimeout(() => {
            document.getElementById('email').focus();
        }, 100);
    }

    hideAuthModal() {
        const modal = document.getElementById('authModal');
        modal.classList.add('hidden');
        this.clearAuthForm();
    }

    updateAuthModalMode() {
        const authTitle = document.getElementById('authTitle');
        const authSubmit = document.getElementById('authSubmit');
        const authSwitchText = document.getElementById('authSwitchText');
        const authSwitchBtn = document.getElementById('authSwitchBtn');

        if (this.isSignUp) {
            authTitle.textContent = 'Create Account';
            authSubmit.textContent = 'Sign Up';
            authSwitchText.textContent = 'Already have an account?';
            authSwitchBtn.textContent = 'Sign In';
        } else {
            authTitle.textContent = 'Welcome Back';
            authSubmit.textContent = 'Sign In';
            authSwitchText.textContent = "Don't have an account?";
            authSwitchBtn.textContent = 'Sign Up';
        }
    }

    toggleAuthMode() {
        this.isSignUp = !this.isSignUp;
        this.updateAuthModalMode();
        this.clearAuthMessages();
    }

    async handleAuth(e) {
        e.preventDefault();

        if (!this.debugger.isInitialized) {
            this.showAuthMessage('error', 'Firebase not initialized. Check configuration.');
            logger.error('Authentication attempted but Firebase not initialized');
            return;
        }

        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value;

        // Validation
        if (!email || !password) {
            this.showAuthMessage('error', 'Please fill in all fields');
            return;
        }

        if (password.length < 6) {
            this.showAuthMessage('error', 'Password must be at least 6 characters');
            return;
        }

        logger.info(`Attempting to ${this.isSignUp ? 'sign up' : 'sign in'}: ${email}`);

        this.clearAuthMessages();

        const submitBtn = document.getElementById('authSubmit');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = this.isSignUp ? 'Creating Account...' : 'Signing In...';
        submitBtn.disabled = true;

        try {
            if (this.isSignUp) {
                const userCredential = await this.debugger.auth.createUserWithEmailAndPassword(email, password);
                logger.success(`Account created successfully: ${userCredential.user.uid}`);
                this.showAuthMessage('success', 'Account created successfully!');
            } else {
                const userCredential = await this.debugger.auth.signInWithEmailAndPassword(email, password);
                logger.success(`Sign in successful: ${userCredential.user.uid}`);
            }

        } catch (error) {
            logger.error(`Authentication error: ${error.code} - ${error.message}`);
            this.handleAuthError(error);
        } finally {
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    }

    handleAuthError(error) {
        let errorMessage = error.message;

        // Provide user-friendly error messages
        switch (error.code) {
            case 'auth/user-not-found':
                errorMessage = 'No account found with this email. Please sign up first.';
                break;
            case 'auth/wrong-password':
                errorMessage = 'Incorrect password. Please try again.';
                break;
            case 'auth/email-already-in-use':
                errorMessage = 'An account with this email already exists. Try signing in instead.';
                break;
            case 'auth/weak-password':
                errorMessage = 'Password should be at least 6 characters long.';
                break;
            case 'auth/invalid-email':
                errorMessage = 'Please enter a valid email address.';
                break;
            case 'auth/network-request-failed':
                errorMessage = 'Network error. Please check your internet connection.';
                break;
            case 'auth/unauthorized-domain':
                errorMessage = 'This domain is not authorized. Check Firebase console settings.';
                break;
            default:
                errorMessage = `Authentication failed: ${error.code}`;
        }

        this.showAuthMessage('error', errorMessage);
    }

    async signOut() {
        if (!this.debugger.isInitialized) return;

        try {
            await this.debugger.auth.signOut();
            logger.success('User signed out successfully');
        } catch (error) {
            logger.error(`Sign out error: ${error.message}`);
        }
    }

    startDemoMode() {
        logger.info('Starting demo mode...');
        this.user = { email: 'demo@example.com', uid: 'demo-user' };
        this.updateUI();
        this.showTrackerApp();
    }

    updateUI() {
        const guestNav = document.getElementById('guestNav');
        const authNav = document.getElementById('authNav');
        const userEmail = document.getElementById('userEmail');

        if (this.user) {
            guestNav.classList.add('hidden');
            authNav.classList.remove('hidden');
            userEmail.textContent = this.user.email;
        } else {
            guestNav.classList.remove('hidden');
            authNav.classList.add('hidden');
        }
    }

    showTrackerApp() {
        document.getElementById('landingSection').classList.add('hidden');
        document.getElementById('trackerApp').classList.remove('hidden');
        this.hideAuthModal();
    }

    showLandingPage() {
        document.getElementById('landingSection').classList.remove('hidden');
        document.getElementById('trackerApp').classList.add('hidden');
    }

    testAuthentication() {
        logger.info('Testing authentication setup...');

        if (!this.debugger.isInitialized) {
            logger.error('Cannot test auth - Firebase not initialized');
            return;
        }

        logger.info('Auth service ready for testing');
        logger.info('Try signing up with a test email to verify authentication');
    }

    showAuthMessage(type, message) {
        const errorEl = document.getElementById('authError');
        const successEl = document.getElementById('authSuccess');

        if (type === 'error') {
            errorEl.textContent = message;
            errorEl.classList.remove('hidden');
            successEl.classList.add('hidden');
        } else {
            successEl.textContent = message;
            successEl.classList.remove('hidden');
            errorEl.classList.add('hidden');
        }
    }

    clearAuthMessages() {
        const errorEl = document.getElementById('authError');
        const successEl = document.getElementById('authSuccess');
        errorEl.textContent = '';
        successEl.textContent = '';
        errorEl.classList.add('hidden');
        successEl.classList.add('hidden');
    }

    clearAuthForm() {
        document.getElementById('email').value = '';
        document.getElementById('password').value = '';
        this.clearAuthMessages();
    }
}

// Initialize when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    logger.info('DOM loaded, starting application...');

    try {
        window.tracker = new DevOpsTracker();
    } catch (error) {
        logger.error(`Failed to initialize application: ${error.message}`);
        console.error('Initialization error:', error);
    }
});
    </script>
</body>
</html>
